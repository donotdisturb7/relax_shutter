import{r as v,o,h as w,e as c,a as r,u as d,b as e,f as U,t as i,d as y,C as M,c as u,w as $,Z as O,n as P,F as I,k as S,D as C}from"./app-BI7OEea5.js";import{_ as A}from"./AuthenticatedLayout-D73ka3ot.js";import{_ as B}from"./PostCard-b7mVmkhl.js";import{Y as N,h as D,G as V,V as E,r as z,S as L}from"./transition-CYIWtLHr.js";import{r as G}from"./PencilIcon-DUb74lms.js";/* empty css            */import"./TextInput-Do9Sxgfw.js";const R={class:"fixed inset-0 overflow-y-auto"},T={class:"flex min-h-full items-center justify-center p-4 text-center"},j={__name:"ImageModal",props:{title:{type:String,required:!1}},setup(a,{expose:b}){const n=v(!1),f=()=>{n.value=!0},l=()=>{n.value=!1};return b({open:f,close:l}),(p,h)=>(o(),w(d(L),{appear:"",show:n.value,as:"template"},{default:c(()=>[r(d(N),{as:"div",onClose:l,class:"relative z-50"},{default:c(()=>[r(d(D),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>h[0]||(h[0]=[e("div",{class:"fixed inset-0 bg-black/25"},null,-1)])),_:1}),e("div",R,[e("div",T,[r(d(D),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[r(d(V),{class:"w-full max-w-md transform overflow-hidden rounded bg-white dark:bg-slate-900 text-left align-middle shadow-xl transition-all"},{default:c(()=>[a.title?(o(),w(d(E),{key:0,as:"h3",class:"flex items-center justify-between py-3 px-4 font-medium bg-gray-100 dark:bg-slate-800 text-gray-900 dark:text-gray-100"},{default:c(()=>[U(i(a.title)+" ",1),e("button",{onClick:l,class:"w-8 h-8 rounded-full hover:bg-black/5 dark:hover:bg-black/30 transition flex items-center justify-center"},[r(d(z),{class:"w-4 h-4"})])]),_:1})):y("",!0),M(p.$slots,"default")]),_:3})]),_:3})])])]),_:3})]),_:3},8,["show"]))}},Y={class:"p-4"},q={key:0},W={class:"text-gray-600 mb-4"},Z={key:1},H=["src"],F={__name:"ImageUpload",props:{aspectRatio:{type:Number,default:1}},emits:["uploaded"],setup(a,{emit:b}){const n=b,f=v(null),l=v(null),p=v(null),h=s=>{const t=s.target.files[0];t&&g(t)},_=s=>{const t=s.dataTransfer.files[0];t&&g(t)},g=s=>{s.type.startsWith("image/")&&(l.value=s,p.value=URL.createObjectURL(s))},k=()=>{l.value&&(n("uploaded",l.value),x())},x=()=>{l.value=null,p.value=null,f.value&&(f.value.value="")};return(s,t)=>(o(),u("div",Y,[e("div",{class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",onDragover:t[1]||(t[1]=$(()=>{},["prevent"])),onDrop:$(_,["prevent"])},[e("input",{type:"file",ref_key:"fileInput",ref:f,class:"hidden",onChange:h,accept:"image/*"},null,544),l.value?(o(),u("div",Z,[e("img",{src:p.value,class:"max-w-full max-h-64 mx-auto mb-4",alt:"Preview"},null,8,H),e("div",{class:"flex justify-center space-x-4"},[e("button",{onClick:k,class:"bg-blue-500 text-white px-4 py-2 rounded-md"}," Enregistrer "),e("button",{onClick:x,class:"bg-gray-500 text-white px-4 py-2 rounded-md"}," Annuler ")])])):(o(),u("div",q,[e("div",W,[t[2]||(t[2]=U(" Glissez une image ici ou ")),e("button",{onClick:t[0]||(t[0]=m=>s.$refs.fileInput.click()),class:"text-blue-500 hover:text-blue-600"}," parcourez ")])]))],32)]))}},J={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-8"},K={class:"relative h-64 w-full rounded-lg overflow-hidden mb-16 bg-white dark:bg-slate-800"},Q=["src"],X={class:"absolute -bottom-12 left-8"},ee={class:"relative"},te=["src","alt"],ae={class:"text-sm text-gray-500"},se={class:"px-8"},oe={class:"flex justify-between items-start"},le={class:"text-2xl font-bold text-gray-900 dark:text-white"},re={class:"text-gray-600 dark:text-gray-400"},ne={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},ie={class:"flex space-x-8 mt-6 border-b border-gray-200 dark:border-slate-700 pb-4"},de={class:"text-center"},ce={class:"block font-bold text-xl"},ue={class:"text-center"},fe={class:"block font-bold text-xl"},pe={class:"text-center"},me={class:"block font-bold text-xl"},ve={class:"mt-8"},be={key:0,class:"text-center py-8 text-gray-500"},he={key:1,class:"space-y-6"},$e={__name:"Index",props:{user:Object,stats:Object,posts:Object,isCurrentUserFollower:Boolean,isOwnProfile:Boolean},setup(a){const b=a,n=v(b.isCurrentUserFollower),f=v(null),l=v(null),p=async()=>{try{const s=await C.post(route("user.follow",{user:b.user.id}));n.value=s.data.following}catch(s){console.error("Erreur lors du follow/unfollow:",s)}},h=()=>{f.value.open()},_=()=>{l.value.open()},g=async s=>{const t=new FormData;t.append("avatar",s),t.append("type","avatar");try{await C.post(route("profile.updateImages"),t),window.location.reload()}catch(m){console.error("Erreur lors du téléchargement de l'avatar:",m)}},k=async s=>{const t=new FormData;t.append("cover",s),t.append("type","cover");try{await C.post(route("profile.updateImages"),t),window.location.reload()}catch(m){console.error("Erreur lors du téléchargement de la couverture:",m)}},x=()=>{window.location.reload()};return(s,t)=>(o(),w(A,null,{default:c(()=>[r(d(O),{title:`Profil de ${a.user.name}`},null,8,["title"]),e("div",J,[e("div",K,[e("img",{src:a.user.cover_path?`/storage/${a.user.cover_path}`:"/images/default-cover.png",class:"w-full h-full object-cover",alt:"Cover photo"},null,8,Q),e("div",X,[e("div",ee,[e("img",{src:a.user.avatar_path&&a.user.avatar_path.length>0?`/storage/${a.user.avatar_path}`:"/images/default-avatar.png",class:"w-32 h-32 rounded-full border-4 border-white object-cover",alt:a.user.name},null,8,te),e("div",ae,"Debug: "+i(a.user.avatar_path),1),a.isOwnProfile?(o(),u("button",{key:0,onClick:h,class:"absolute bottom-0 right-0 bg-blue-500 text-white rounded-full p-2"},[r(d(G),{class:"w-4 h-4"})])):y("",!0)])]),a.isOwnProfile?(o(),u("button",{key:0,onClick:_,class:"absolute bottom-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-md"}," Modifier la couverture ")):y("",!0)]),e("div",se,[e("div",oe,[e("div",null,[e("h1",le,i(a.user.name),1),e("p",re,"@"+i(a.user.username),1),e("p",ne," Membre depuis "+i(new Date(a.user.created_at).toLocaleDateString()),1)]),a.isOwnProfile?y("",!0):(o(),u("button",{key:0,onClick:p,class:P(["px-6 py-2 rounded-full font-medium",n.value?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"])},i(n.value?"Ne plus suivre":"Suivre"),3))]),e("div",ie,[e("div",de,[e("span",ce,i(a.stats.posts_count),1),t[0]||(t[0]=e("span",{class:"text-gray-600"},"Publications",-1))]),e("div",ue,[e("span",fe,i(a.stats.followers_count),1),t[1]||(t[1]=e("span",{class:"text-gray-600"},"Abonnés",-1))]),e("div",pe,[e("span",me,i(a.stats.following_count),1),t[2]||(t[2]=e("span",{class:"text-gray-600"},"Abonnements",-1))])]),e("div",ve,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Publications",-1)),a.posts.data.length===0?(o(),u("div",be," Aucune publication pour le moment ")):(o(),u("div",he,[(o(!0),u(I,null,S(a.posts.data,m=>(o(),w(B,{key:m.id,post:m,onDeleted:x},null,8,["post"]))),128))]))])])]),r(j,{ref_key:"avatarModal",ref:f,title:"Modifier la photo de profil"},{default:c(()=>[r(F,{onUploaded:g,"aspect-ratio":1})]),_:1},512),r(j,{ref_key:"coverModal",ref:l,title:"Modifier la photo de couverture"},{default:c(()=>[r(F,{onUploaded:k,"aspect-ratio":2.5})]),_:1},512)]),_:1}))}};export{$e as default};
